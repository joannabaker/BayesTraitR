---
title: "BayesTraitR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{BayesTraitR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
The goal of BayesTraitR is to facilitate phylogenetic comparative analyses in BayesTraits for R users. It comprises a suite of functions and tools that will be useful for wrangling datasets and trees into the appropriate format for analyses within BayesTraits as well as for interpreting and post-processing the outcomes of such analyses.

In this vignette, there are step-by-step tutorials provided for setting up, running, and interpreting multiple types of analyses that can be conducted using BayesTraits. This includes the following: 

**Jump to:**

1) [Multi-State models](#multistate)

2) [Variable-Rates models (both single-trait and regression)](#vr)

3) [In development: Fabric models (both single-trait and regression)](#fabric)

4) [In development: Geo models](#geo)

All of these tutorials require loading BayesTraitR:

```{r setup}
library(BayesTraitR)
```

<a id="multistate"></a>

## A worked example of creating and post-processing a multi-state model

We can create a multi-state model using the example files that are bundled with the BayesTraits download. These example files are also included as a part of this package. 

Please note that for this and all worked examples, the datasets are small and incomplete and should not be used for any scientific interpretation. They are included as illustrative examples of how to interact with BayesTraits and BayesTraitR only.

To **create a maximum-likelihood multi-state model** across the Artiodactyl dataset and tree sample, we can use the following commands: 

``` r
createBTjob(cols = "multistate", dataset = Artiodactyl, tree = Artiodactyl_trees, jobname = "MultiStateML", model = 1, MCMC = F)
```

Note that we specify the following arguments:

* **jobname = "MultiStateML"**: This sets an identifier string with which all output files will be tagged.

* **cols = "multistate"**: This specifies the column we wish to run the model over in the input dataset. 

* **model = 1**: This specifies the multi-state model.

* **MCMC = F**: By selecting to not use MCMC, the model will revert to maximum-likelihood.

All other parameters are set to the default values. 

Running the above command will create a series of files in your current working directory:

* MultiStateML-001.txt

* MultiStateML.trees

* MultiStateML.infile


These files can then be used to run BayesTraits, either separately through your command-line interface or using shell (or similar) options direction from within R. 

For example:

``` r
shell("BayesTraitsV4.exe MultiStateML.trees MultiStateML-001.txt < MultiStateML.infile")
```

Running BayesTraits with these files will create a log file in your current working directory:

* MultiStateML-001.txt.Log.txt

Now, we can read in the log file into our R workspace using the function \code{readBTlog} from this package. 

``` {r, include=T}
log = readBTlog("inst/extdata/MultiStateML-001.txt.Log.txt")
```

We can view this like we would any other R data.frame. Let's look at what the output looks like.
```{r,echo=T,include=T}
head(log)
```

**Coming soon...**
Plot the transition rates

<a id="vr"></a>
